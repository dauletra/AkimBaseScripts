SELECT sum(KUKURUZA) FROM ZEM
	WHERE
	id_catal NOT IN (24134, 24141, 24147, 24151, 24156, 24164, 24173, 24177, 24181, 24197, 24203, 24212, 24224, 24237, 24243, 24234, 49324);

UPDATE ZEM
	SET KUKURUZA = KORM_KUKURUZA;

UPDATE ZEM
	SET ZERNO = KUKURUZA;

UPDATE ZEM
	SET posev = coalesce(semena_masl, 0) + coalesce(ovoshi, 0) + coalesce(soloma, 0);
	

UPDATE ZEM
	SET OVOSHI = COALESCE(KAPUSTA, 0) + COALESCE(OGURCY, 0) + COALESCE(BAKLAZHAN, 0) + COALESCE(POMIDOR, 0) + 
	COALESCE(MORKOV, 0) + COALESCE(CHESNOK, 0) + COALESCE(LUK, 0) + COALESCE(KARTOFEL, 0);

UPDATE ZEM
	SET soloma = COALESCE(KORM_KUKURUZA, 0) + COALESCE(korm_seno, 0)

SELECT pashnya FROM zem
	WHERE pashnya < COALESCE(SEMENA_MASL, 0) + COALESCE(ovoshi, 0) + COALESCE(SOLOMA, 0);
	
SELECT count(*) FROM KPU_CATAL;
SELECT sum(KORM_SENO) FROM ZEM; 
-- (24134, 24141, 24147, 24151, 24156, 24164, 24173, 24177, 24181, 24197, 24203, 24212, 24224, 24237, 24243, 24234, 49324)

UPDATE ZEM
	SET KORM_SENO = COALESCE(korm_seno, 0) + 100
	WHERE PASHNYA > COALESCE(SEMENA_PODS, 0) + COALESCE(OVOSHI, 0) + COALESCE(SOLOMA, 0) + COALESCE(korm_seno, 0) + 100 AND
	id_catal NOT IN (24134, 24141, 24147, 24151, 24156, 24164, 24173, 24177, 24181, 24197, 24203, 24212, 24224, 24237, 24243, 24234, 49324)
	ROWS 449
	

SELECT VSEGO, POSTROYKI, PASHNYA, ZEM_OTHER, POSTROYKI + PASHNYA + ZEM_OTHER,
		VSEGO - (POSTROYKI + PASHNYA + MNOGOLETNIE + ZEM_OTHER) FROM zem WHERE id_catal=17371;